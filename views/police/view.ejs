<div x-data="{ activeTab: 'Info', counts: {} }" x-init="
  fetch('/api/bookings/<%= booking.id %>/counts')
    .then(res => res.json())
    .then(data => counts = data)
">
  <ul class="flex border-b">
    <% ['Info','Victims','Evidence','Witnesses','Hearings','Notes'].forEach(tab=>{ %>
      <li class="mr-4">
        <a @click.prevent="activeTab='<%=tab%>'"
           :class="activeTab==='<%=tab%>' && 'border-b-2 border-blue-600'"
           href="#">
          <%=tab%> <span x-text="counts.<%=tab.toLowerCase()%>"></span>
        </a>
      </li>
    <% }) %>
  </ul>

  <div x-show="activeTab==='Info'">
    <h2>Booking Details</h2>
    <p><strong>Person:</strong> <%= booking.person.name %></p>
    <p><strong>Status:</strong> <%= booking.status %></p>
  </div>

  <div x-show="activeTab==='Victims'" x-init="
    fetch('/api/bookings/<%= booking.id %>/victims')
      .then(res => res.text())
      .then(html => $el.innerHTML = html)
  "></div>

  <div x-show="activeTab==='Evidence'" x-init="
    fetch('/api/bookings/<%= booking.id %>/evidence')
      .then(res => res.text())
      .then(html => $el.innerHTML = html)
  "></div>

  <div x-show="activeTab==='Witnesses'" x-init="
    fetch('/api/bookings/<%= booking.id %>/witnesses')
      .then(res => res.text())
      .then(html => $el.innerHTML = html)
  "></div>

  <div x-show="activeTab==='Hearings'" x-init="
    fetch('/api/bookings/<%= booking.id %>/hearings')
      .then(res => res.text())
      .then(html => $el.innerHTML = html)
  "></div>

  <div x-show="activeTab==='Notes'">
    <h3>Officer Notes</h3>
    <p><%= booking.officerNotes || 'No notes yet' %></p>
  </div>
</div>

<hr>

<h3>Linked Case</h3>
<% if (!booking.case) { %>
  <form method="POST" action="/case/create">
    <input type="hidden" name="bookingId" value="<%= booking.id %>">
    <button>Create Case</button>
  </form>
<% } else { %>
  <a href="/police/bookings/<%= booking.id %>/edit">Edit Case</a>
<% } %>

<hr>

<a href="/police/dashboard">‚Üê Back to Dashboard</a>
